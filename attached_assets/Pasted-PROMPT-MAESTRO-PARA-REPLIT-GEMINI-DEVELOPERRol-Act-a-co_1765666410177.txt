PROMPT MAESTRO PARA REPLIT / GEMINI DEVELOPERRol: Actúa como un Arquitecto de Software Senior y Experto en Integraciones de IA (Gemini) y Logística Internacional.Proyecto: App 'ImportaYAia.com'Objetivo: Refactorizar el módulo de "Solicitud de Cotización" (Quote Request Form) para implementar lógica de negocio crítica, validaciones de UX avanzadas y flujos de automatización de correos.Necesito que modifiques el código actual para implementar los siguientes 4 Bloques de Funcionalidad. Debes asegurar que frontend y backend estén sincronizados.BLOQUE 1: Validación de RUC y Flujo de "Lead Qualification"Lógica:RUC Obligatorio Condicional: Al momento que un LEAD intenta enviar su primera solicitud de cotización, el campo RUC (Tax ID) se vuelve estrictamente obligatorio. No se permite el envío sin este dato.Verificación SENAE (Aduana):Si el Lead indica que NO tiene RUC o NO es importador registrado (check is_oce_registered = False), bloquear la cotización y mostrar un Modal/Disclaimer Bloqueante:Mensaje: "IMPORTAYAIA.COM es una herramienta para Importadores Registrados ante la SENAE. Hemos enviado una alerta automática a nuestro Ejecutivo de Aduanas para asistirte con tu registro de RUC y OCE antes de operar."Acción Backend: Disparar correo al "Ejecutivo de Aduana" con los datos del Lead.Disclaimer General: Agregar un aviso visible en el Dashboard: "Servicio exclusivo para Importadores Calificados".BLOQUE 2: Flujo de Aprobación de Cotización (Vendor Lock-in Check)Workflow Automático:Al recibir la primera cotización válida (con RUC), el sistema NO debe mostrar el precio inmediatamente si es la primera vez.Trigger de Correo: Enviar un email automático al FREIGHT_FORWARDER_EMAIL (configurado por el Master Admin).Asunto: "Validación de Cliente: RUC [Insertar RUC]"Cuerpo: Solicitud de revisión para confirmar si este RUC ya es cliente actual del Forwarder.Lógica de Profit Margin (Pricing Engine):Escenario A (Cliente Existente del Forwarder): Si el Forwarder marca al cliente como "Existente" (o si no se recibe liberación), el sistema generará la cotización con un esquema de PROTECCIÓN: Profit Mínimo de USD $500 por embarque (FCL/LCL/Aéreo), prorrateado entre los rubros.Escenario B (Cliente Nuevo): Si es liberado, el sistema genera la cotización automática con el Standard Profit Margin configurado en la App.BLOQUE 3: UX Avanzada de Selección de Puertos (POL/POD) y AeropuertosComponente: SmartLocationSelectorEste componente debe reemplazar los selectores simples actuales para FCL, LCL y Aéreo.Funcionalidad Híbrida:Modo "Drill-down" (Jerárquico): Permitir al usuario filtrar por: Región -> País -> Puerto/Aeropuerto.Modo "Autocomplete" (Search): Permitir escribir directamente "Shangh..." y que aparezca "SHANGHAI, CHINA".Persistencia: Si usa el drill-down o el buscador, el resultado final (pol_id o pod_id) debe guardarse igual.BLOQUE 4: Lógica de Carga y Calculadora InteligenteA. Para Marítimo FCL:Multi-Contenedor: Habilitar UI para agregar múltiples líneas de contenedores (Ej: 2x20GP + 1x40HC en la misma solicitud).Validación de Peso: Campo gross_weight opcional, PERO con restricción dura (Hard Constraint): Máximo 27,000 KG (27 Ton) por contenedor. Mostrar error si excede.B. Para Marítimo LCL y Aéreo:Calculadora Volumétrica (Auto-Calc):Inputs: Largo, Ancho, Alto, Unidad (CM o Pulgadas).Output: Total Volumen (CBM) calculado automáticamente en tiempo real.Fórmula: Si es CM: $(L \times W \times H) / 1,000,000$. Si es Inches, convertir primero.Override Manual: El campo Total CBM debe ser editable. Si el usuario lo edita manualmente, se respeta su valor sobre el calculado.Entregable:Provee el código actualizado para los modelos de base de datos (schema), las funciones de backend (API routes) y los componentes de React para el frontend que cumplan estrictamente con estas reglas.Análisis de lo que hace este Prompt "Super Humano":Cubre las Lagunas: Define qué pasa si el usuario edita el volumen manualmente (Override), algo vital que a veces se olvida.Protege tu Negocio: La lógica del "Profit de $500" para clientes que ya son del forwarder evita la canibalización de precios (competir contra ti mismo).Mejora la UX: Especifica claramente el componente "Híbrido" para seleccionar puertos, que es la mejor práctica actual (escribir o buscar por mapa/región).Validación Técnica: Pone límites duros (27 toneladas) para evitar cotizaciones irreales que luego causan problemas operativos.